# Milestone 10: boon-console (Full)

**Status**: Not Started

## Overview

Extend the basic boon-console from M4 into a full runtime diagnostics tool with graph visualization, state inspection, and time-travel debugging. Connect to any Boon platform and visualize what's happening inside the reactive graph.

---

## Success Criteria

- [ ] 3D graph visualization of reactive nodes
- [ ] State inspection (click node to see value)
- [ ] Time-travel debugging (replay events)
- [ ] Breakpoints (pause on specific events)
- [ ] Performance profiling (identify slow nodes)
- [ ] Connect to FPGA simulator (digitaljs internals)

---

## Dependencies

- **Requires**: M4 (Super-Counter) - provides basic boon-console and debug protocol
- **Enables**: M11 (desktop app with visualizations)

---

## Key Features

| Feature | Description |
|---------|-------------|
| Multi-platform connect | Browser, CLI, server, FPGA |
| Graph visualization | See reactive nodes and edges |
| Event stream | Watch events as they flow |
| State inspection | Click node to see current value |
| Time-travel | Replay historical events |
| Breakpoints | Pause on specific events |
| Performance | Identify slow nodes, bottlenecks |

---

## Architecture

```
┌─────────────────────────────────────────────────────────────┐
│                     boon-console UI                          │
│   (Graph view, event log, state inspector, timeline)         │
└─────────────────────────────────────────────────────────────┘
                            │
                      WebSocket
                            │
            ┌───────────────┼───────────────┬───────────────┐
            ▼               ▼               ▼               ▼
      ┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐
      │ Browser │     │   CLI   │     │ Server  │     │  FPGA   │
      │  Boon   │     │  Boon   │     │  Boon   │     │   Sim   │
      └─────────┘     └─────────┘     └─────────┘     └─────────┘
         :8082           :8083           :8084           :8085
```

---

## Debug Protocol

Each Boon runtime exposes a debug WebSocket endpoint:

```json
// Event: Node created
{"type": "node_created", "id": "slot_42", "kind": "Register", "name": "counter"}

// Event: Message sent
{"type": "message", "from": "slot_12", "to": "slot_42", "payload": {"count": 5}}

// Event: State changed
{"type": "state_changed", "id": "slot_42", "old": {"count": 4}, "new": {"count": 5}}

// Command: Inspect node
{"cmd": "inspect", "id": "slot_42"}

// Command: Pause/resume
{"cmd": "pause"}
{"cmd": "resume"}
```

---

## Visualization Modes

| Mode | Description |
|------|-------------|
| Graph | Reactive nodes as boxes, edges as arrows |
| Timeline | Events on horizontal time axis |
| Log | Text stream of events |
| Flame | Performance flame graph |
| Diff | Before/after state comparison |

---

## Connection Methods

| Platform | Connection |
|----------|------------|
| Browser playground | `ws://localhost:8081/debug` (playground adds endpoint) |
| CLI runtime | `boon run --debug-port 8083` |
| Server | `boon serve --debug-port 8084` |
| FPGA simulator | digitaljs exposes internal state |

---

## boon-console Modes

| Mode | Description |
|------|-------------|
| Web UI | Open `http://localhost:9000` in browser |
| CLI | `boon-console --connect localhost:8083` |
| Desktop | Part of M11 Servo-RayBox app |

---

## Implementation Approach

### Phase 1: Protocol
- Define debug message format (JSON over WebSocket)
- Add debug endpoint to engine
- Basic connect/disconnect

### Phase 2: CLI Console
- Text-based event viewer
- Node inspection commands
- Simple TUI with event log

### Phase 3: Web UI
- React/Svelte web app for visualization
- Graph rendering (D3.js or similar)
- Interactive node clicking

### Phase 4: Integration
- Connect to browser playground
- Connect to FPGA simulator
- Time-travel / replay

---

## Testing Strategy

- Unit tests for protocol parsing
- Integration tests connecting to test Boon instances
- Visual tests for graph rendering
- Performance tests with high event volume

---

## Related Documentation

- §3.5 Diagnostics - runtime diagnostics design
- M0 - CLI adds debug port support
- M11 - Desktop app includes boon-console visualizations
