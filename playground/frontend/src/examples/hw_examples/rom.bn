-- Simple asynchronous ROM
-- Parameterized address and data width
-- Memory initialized with address as data

FUNCTION rom(addr) {
    BLOCK {
        -- ROM content: each address contains its own value
        -- This models: initial for (i = 0; i < 2**AWIDTH; i = i+1) mem[i] = i;

        mem: MEMORY[16] { 0  }
            |> Memory/initialize(i, data: i)

        -- Asynchronous read
        data: mem |> Memory/read(address: addr)

        [data: data]
    }
}
