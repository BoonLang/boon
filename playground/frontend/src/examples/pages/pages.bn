-- Multi-Page App: Navigate between pages using buttons
-- Exercises: Router/route, Router/go_to, WHEN/WHILE patterns

store: [nav: [home: LINK, about: LINK, contact: LINK]]

current_route: Router/route()

-- Navigate when buttons are pressed
nav_action: LATEST {
    store.nav.home.event.press |> THEN { TEXT { / } }
    store.nav.about.event.press |> THEN { TEXT { /about } }
    store.nav.contact.event.press |> THEN { TEXT { /contact } }
} |> Router/go_to()

current_page: current_route |> WHEN {
    TEXT { / } => Home
    TEXT { /about } => About
    TEXT { /contact } => Contact
    __ => NotFound
}

document: Document/new(root: Element/stripe(
    element: []
    direction: Column
    gap: 0
    style: [width: Fill, height: Fill]
    items: LIST {
        -- Navigation bar
        Element/stripe(
            element: []
            direction: Row
            gap: 8
            style: [width: Fill, padding: 16, background: [color: Oklch[lightness: 0.15]]]
            items: LIST {
                nav_button(label: TEXT { Home }, route: TEXT { / }) |> LINK { store.nav.home }
                nav_button(label: TEXT { About }, route: TEXT { /about }) |> LINK { store.nav.about }
                nav_button(label: TEXT { Contact }, route: TEXT { /contact }) |> LINK { store.nav.contact }
            }
        )
        -- Page content
        Element/container(
            element: []
            style: [width: Fill, height: Fill, padding: 24]
            child: current_page |> WHILE {
                Home => page(title: TEXT { Welcome Home }, desc: TEXT { This is the home page. Use the navigation above to explore. })
                About => page(title: TEXT { About }, desc: TEXT { A multi-page Boon app demonstrating Router/route and Router/go_to. })
                Contact => page(title: TEXT { Contact }, desc: TEXT { Get in touch! URL-driven state and navigation demo. })
                NotFound => page(title: TEXT { 404 - Not Found }, desc: TEXT { The page you're looking for doesn't exist. })
            }
        )
    }
))

FUNCTION nav_button(label, route) {
    BLOCK {
        is_active: current_route == route
        Element/button(
            element: [event: [press: LINK]]
            style: [
                padding: [row: 16, column: 8]
                background: [color: is_active |> WHEN { True => Oklch[lightness: 0.3], False => Oklch[lightness: 0.2] }]
                rounded_corners: 4
                font: [
                    color: is_active |> WHEN { True => White, False => Oklch[lightness: 0.7] }
                    weight: is_active |> WHEN { True => Bold, False => Regular }
                ]
            ]
            label: label
        )
    }
}

FUNCTION page(title, desc) {
    Element/stripe(
        element: []
        direction: Column
        gap: 16
        style: []
        items: LIST {
            Element/label(element: [], style: [font: [size: 32, weight: Bold]], label: title)
            Element/label(element: [], style: [font: [color: Oklch[lightness: 0.5]]], label: desc)
        }
    )
}
