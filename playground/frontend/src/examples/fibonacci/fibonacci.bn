FUNCTION fibonacci(position) {
    [current: 0, next: 1] |> HOLD state {
        position |> Stream/pulses() |> THEN {
            [current: state.next, next: state.current + state.next]
        }
    }
    |> Stream/skip(count: position)
    |> .current
}

position: 10
result: position |> fibonacci()
message: TEXT { {position}. Fibonacci number is {result} }
document: message |> Log/info() |> Document/new()
