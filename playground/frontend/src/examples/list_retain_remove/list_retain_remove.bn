-- Test: Can List/retain be used at list source to remove specific items?
-- Simplified: Remove items by clicking their X button

store: [
    input: LINK
    text_to_add: input.event.key_down.key |> WHEN {
        Enter => BLOCK {
            trimmed: input.text |> Text/trim()
            trimmed |> Text/is_not_empty() |> WHEN {
                True => trimmed
                False => SKIP
            }
        }
        __ => SKIP
    }

    items: LIST { TEXT { Apple }, TEXT { Banana }, TEXT { Cherry } }
        |> List/append(item: text_to_add)
]

document: Document/new(root: Element/stripe(
    element: []
    direction: Column
    gap: 10
    style: [padding: 20]
    items: LIST {
        Element/label(
            element: []
            style: [font: [size: 20]]
            label: TEXT { Add items with Enter }
        )

        Element/text_input(
            element: [event: [key_down: LINK, change: LINK]]
            style: [width: 300]
            label: Hidden[text: TEXT { Item name }]
            text: LATEST { Text/empty(), element.event.change.text, store.text_to_add |> THEN { Text/empty() } }
            placeholder: [text: TEXT { Type and press Enter }]
            focus: True
        ) |> LINK { store.input }

        Element/label(
            element: []
            style: []
            label: TEXT { Count: {store.items |> List/count()} }
        )

        Element/stripe(
            element: []
            direction: Column
            gap: 5
            style: []
            items: store.items |> List/map(item, new:
                Element/label(
                    element: []
                    style: []
                    label: TEXT { - {item} }
                )
            )
        )
    }
))
